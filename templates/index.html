<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="subCIS TierList">
  <link rel="icon" href="/static/icons/overall.svg" type="image/x-icon"> <!-- Иконка сайта -->
  <title>subCIS | TierList</title>
  <style>
    body {
      background: #333; /* Серый фон для сайта */
      color: white;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
    }
    /* Верхний бар с кнопкой Discords */
    .top-bar {
      background-color: #222; /* Темно-серый фон для верхнего бара */
      padding: 10px 0;
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
    }
    .discords-button {
      background-color: #444;
      padding: 8px 15px; /* Меньше по размерам */
      border-radius: 8px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      color: white;
      font-size: 16px; /* Меньше размер шрифта */
      border: 2px solid #666;
      transition: background-color 0.3s;
    }
    .discords-button:hover {
      background-color: #555;
    }
    .discords-button img {
      width: 18px; /* Меньше иконка */
      height: 18px;
    }

    /* Выпадающее меню */
    .discord-menu {
      display: none;
      position: absolute;
      top: 50px;
      background-color: #222;
      border: 1px solid #444;
      border-radius: 8px;
      width: 200px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
      z-index: 100;
    }
    .discord-menu a {
      display: flex;
      align-items: center;
      padding: 10px;
      color: white;
      text-decoration: none;
      font-size: 16px;
    }
    .discord-menu a:hover {
      background-color: #555;
      border-radius: 5px;
    }
    .discord-menu a img {
      width: 20px;
      height: 20px;
      margin-right: 10px; /* Расстояние между иконкой и текстом */
    }
    /* При нажатии на кнопку отображаем меню */
    .discords-button.active + .discord-menu {
      display: block;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
    }
    h1 {
      text-align: center;
      margin-bottom: 20px;
      font-size: 36px;
    }

    /* Таблица с темно-серым фоном */
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      background-color: #222; /* Темно-серый фон для таблицы */
    }
    th, td {
      padding: 10px;
      border: 1px solid #444;
      text-align: left;
    }
    th {
      background-color: #111;
      color: white;
    }

    /* Блок с кнопками */
    .kit-selector {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      margin-top: 20px; /* Расстояние между заголовком и кнопками */
      padding: 20px;
      background: #222; /* Фон для блока с кнопками */
      border-radius: 8px;
    }
    .kit-button {
      background: #444;
      border: 2px solid #666;
      border-radius: 8px;
      padding: 5px;
      width: 50px; /* Уменьшаем кнопки */
      height: 50px;
      cursor: pointer;
      transition: 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .kit-button img {
      max-width: 30px; /* Уменьшаем иконки */
      max-height: 30px;
    }
    .kit-button:hover, .kit-button.active {
      background: #555;
      border-color: #888;
    }

    /* Цвета для цифр тиров */
    .HT1 { color: #fff84d; }
    .LT1 { color: #ffa851; }
    .HT2 { color: #ff800d; }
    .LT2 { color: #e11b1b; }
    .HT3 { color: #ff3c6f; }
    .LT3 { color: #ff65ee; }
    .HT4 { color: #c666ff; }
    .LT4 { color: #6d97ff; }
    .HT5 { color: #5debff; }
    .LT5 { color: #9f4c0f; }

    /* Стиль для футера */
    footer {
      background-color: #222;
      color: white;
      text-align: center;
      padding: 20px;
      font-size: 14px;
      margin-top: 40px; /* Расстояние между таблицей и футером */
    }
  </style>
</head>
<body>

<!-- Верхний бар с кнопкой Discords -->
<div class="top-bar">
  <div class="discords-button" onclick="toggleMenu()">
    <img src="/static/icons/discord-icon.svg" alt="Discord Icon"> <!-- Путь к иконке изменен -->
    Discords
  </div>

  <!-- Выпадающее меню с ссылками на Discord -->
  <div class="discord-menu" id="discordMenu">
    <a href="https://discord.gg/K4D93SpATK" target="_blank">
      <img src="/static/icons/mace.svg" alt="Mace TierList"> Mace TierLis
    </a>
    <a href="https://discord.gg/ra6gFtDVJr" target="_blank">
      <img src="/static/icons/dia_cart.svg" alt="DiaCart TierLis"> DiaCart TierLis
    </a>
    <a href="https://discord.gg/ra6gFtDVJr" target="_blank">
      <img src="/static/icons/cart.svg" alt="Cart TierLis"> Cart TierLis
    </a>
<a href="https://discord.gg/DyWaJpgpJC" target="_blank">
      <img src="/static/icons/ironpot.svg" alt="IronPot TierLis"> IronPot TierLis
    </a>
<a href="https://discord.gg/qqyqfWe99u" target="_blank">
      <img src="/static/icons/creeper.svg" alt="Creeper TierLis"> Creeper TierLis
    </a>
<a href="https://discord.gg/kprXpJRKG8" target="_blank">
      <img src="/static/icons/dia_smp.svg" alt="DiaSmp TierList"> DiaSmp TierList
    </a>
<a href="https://discord.gg/8fUpT6HJeT" target="_blank">
      <img src="/static/icons/bed.svg" alt="Bed TierList"> Bed TierList
    </a>
<a href="https://discord.gg/zjpK7p8Grs" target="_blank">
      <img src="/static/icons/axe.svg" alt="Axe TierList"> Axe TierList
    </a>
<a href="https://discord.gg/ApDrbRbDEK" target="_blank">
      <img src="/static/icons/bow.svg" alt="Bow TierList"> Bow TierList
    </a>

  </div>
</div>

<div class="container">
  <h1>Тирлист Китов</h1>

  <!-- Блок с кнопками -->
  <div class="kit-selector" id="kitSelector">
    <!-- Кнопки китов -->
  </div>

  <!-- Таблица для отображения игроков -->
  <table id="tiersTable">
    <thead>
      <tr>
        <th>Никнейм</th>
        <th>Тир</th>
      </tr>
    </thead>
    <tbody>
      <!-- Здесь будут отображаться игроки -->
    </tbody>
  </table>
</div>

<!-- Футер с авторскими правами и подписью -->
<footer>
  Copyrights © subCIS 2025 | by @_pipochka
</footer>

<script>
  const kits = ["MACE", "DCART", "CART", "IRONPOT", "CREEPER", "DSMP", "BED", "AXE", "BOW"];
  const tierOrder = ["HT1", "LT1", "HT2", "LT2", "HT3", "LT3", "HT4", "LT4", "HT5", "LT5"];

  const kitIcons = {
    "MACE": "/static/icons/mace.svg",
    "DCART": "/static/icons/dia_cart.svg",
    "CART": "/static/icons/cart.svg",
    "IRONPOT": "/static/icons/ironpot.svg",
    "CREEPER": "/static/icons/creeper.svg",
    "DSMP": "/static/icons/dia_smp.svg",
    "BED": "/static/icons/bed.svg",
    "AXE": "/static/icons/axe.svg",
    "BOW": "/static/icons/bow.svg"
  };

  const kitSelector = document.getElementById('kitSelector');
  const tiersTable = document.getElementById('tiersTable').getElementsByTagName('tbody')[0];

  // Генерируем кнопки с иконками
  kits.forEach(kit => {
    const btn = document.createElement('div');
    btn.className = 'kit-button';

    const img = document.createElement('img');
    img.src = kitIcons[kit];
    img.alt = kit;

    btn.appendChild(img);
    btn.addEventListener('click', () => selectKit(kit, btn));
    kitSelector.appendChild(btn);
  });

  // При загрузке страницы открываем MACE
  window.onload = () => {
    const maceButton = document.querySelector('.kit-button');
    if (maceButton) {
      selectKit('MACE', maceButton);
    }
  };

  function selectKit(kit, btn) {
    document.querySelectorAll('.kit-button').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    fetch(`/api/kits/${kit}`)
      .then(res => res.json())
      .then(data => renderTiers(data));
  }

  function renderTiers(data) {
    // Очищаем таблицу перед рендерингом новых данных
    tiersTable.innerHTML = '';

    let allPlayers = [];
    tierOrder.forEach(tierName => {
      const items = data[tierName];
      if (items && items.length > 0) {
        items.forEach(item => {
          allPlayers.push({
            nickname: item.nickname,
            rank: item.rank
          });
        });
      }
    });

    allPlayers.sort((a, b) => {
      const tierA = tierOrder.indexOf(a.rank);
      const tierB = tierOrder.indexOf(b.rank);
      if (tierA === tierB) {
        return a.nickname.localeCompare(b.nickname);
      }
      return tierA - tierB;
    });

    allPlayers.forEach(player => {
      const row = document.createElement('tr');
      const nicknameCell = document.createElement('td');
      const rankCell = document.createElement('td');

      nicknameCell.textContent = player.nickname;
      rankCell.textContent = player.rank;

      // Добавляем класс с соответствующим цветом для цифры тира
      rankCell.classList.add(player.rank);

      row.appendChild(nicknameCell);
      row.appendChild(rankCell);
      tiersTable.appendChild(row);
    });
  }

  // Функция для открытия/закрытия меню
  function toggleMenu() {
    const menu = document.getElementById('discordMenu');
    const button = document.querySelector('.discords-button');
    button.classList.toggle('active');
    menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
  }
</script>

</body>
</html>
